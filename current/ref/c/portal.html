
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1. C/C++ Portal &#8212; connectal 20.05.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/tracking.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Connectal Examples" href="../examples/index.html" />
    <link rel="prev" title="Connectal C/C++ Libraries" href="c.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../bsv-pkgindex.html" title="Bsv Package Index"
             >bsvpkgs</a> |</li>
        <li class="right" >
          <a href="../examples/index.html" title="Connectal Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="c.html" title="Connectal C/C++ Libraries"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">connectal 20.05.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="c.html" accesskey="U">Connectal C/C++ Libraries</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="c-c-portal">
<h1><span class="section-number">1. </span>C/C++ Portal<a class="headerlink" href="#c-c-portal" title="Permalink to this headline">¶</a></h1>
<div class="section" id="connecting-to-bluesim">
<h2><span class="section-number">1.1. </span>Connecting to Bluesim<a class="headerlink" href="#connecting-to-bluesim" title="Permalink to this headline">¶</a></h2>
<dl class="envvar">
<dt id="envvar-BLUESIM_SOCKET_NAME">
<code class="sig-name descname">BLUESIM_SOCKET_NAME</code><a class="headerlink" href="#envvar-BLUESIM_SOCKET_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p>Controls the name of the socket used for connecting software and hardware simulated by bluesim.</p>
</dd></dl>

</div>
<div class="section" id="connecting-to-xsim-and-verilator">
<h2><span class="section-number">1.2. </span>Connecting to Xsim and Verilator<a class="headerlink" href="#connecting-to-xsim-and-verilator" title="Permalink to this headline">¶</a></h2>
<dl class="envvar">
<dt id="envvar-SOFTWARE_SOCKET_NAME">
<code class="sig-name descname">SOFTWARE_SOCKET_NAME</code><a class="headerlink" href="#envvar-SOFTWARE_SOCKET_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p>Controls the name of the socket used for connecting software and hardware simulated by xsim/verilator.</p>
</dd></dl>

</div>
<div class="section" id="automatically-programming-the-fpga">
<h2><span class="section-number">1.3. </span>Automatically Programming the FPGA<a class="headerlink" href="#automatically-programming-the-fpga" title="Permalink to this headline">¶</a></h2>
<p>Connectal application executables or shared objects contain the FPGA
bitstream in the “fpgadata” section of the ELF file. When the
application (or library) first tries to access the hardware, the
Connectal library automatically programs the FGPA with the associated
bitstream, unless <a class="reference internal" href="#c.noprogram" title="noprogram"><code class="xref c c-data docutils literal notranslate"><span class="pre">noprogram</span></code></a> is set to a non-zero value or
environment variable <span class="target" id="index-0"></span><a class="reference internal" href="../makefile.connectal.build.html#envvar-NOPROGRAM"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NOPROGRAM</span></code></a> is nonzero.</p>
<p>In the case of simulation hardware, the simulator is launched when the
application first tries to access the hardware. This behavior is also
suppressed by a nonzero value for either <a class="reference internal" href="#c.noprogram" title="noprogram"><code class="xref c c-data docutils literal notranslate"><span class="pre">noprogram</span></code></a> or
<span class="target" id="index-1"></span><a class="reference internal" href="../makefile.connectal.build.html#envvar-NOPROGRAM"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">NOPROGRAM</span></code></a>.</p>
<dl class="var">
<dt id="c.noprogram">
int <code class="sig-name descname">noprogram</code><a class="headerlink" href="#c.noprogram" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="#c.noprogram" title="noprogram"><code class="xref c c-data docutils literal notranslate"><span class="pre">noprogram</span></code></a> is set to a non-zero value, then the FPGA is not programmed automatically.</p>
</dd></dl>

</div>
<div class="section" id="tracing-simulation">
<h2><span class="section-number">1.4. </span>Tracing Simulation<a class="headerlink" href="#tracing-simulation" title="Permalink to this headline">¶</a></h2>
<dl class="envvar">
<dt id="envvar-DUMP_VCD">
<code class="sig-name descname">DUMP_VCD</code><a class="headerlink" href="#envvar-DUMP_VCD" title="Permalink to this definition">¶</a></dt>
<dd><p>If set, directs the simulator to dump a VCD trace to the $DUMP_VCD.</p>
</dd></dl>

<dl class="var">
<dt id="c.simulator_dump_vcd">
int <code class="sig-name descname">simulator_dump_vcd</code><a class="headerlink" href="#c.simulator_dump_vcd" title="Permalink to this definition">¶</a></dt>
<dd><p>The application can enable VCD tracing by setting
<a class="reference internal" href="#c.simulator_dump_vcd" title="simulator_dump_vcd"><code class="xref c c-data docutils literal notranslate"><span class="pre">simulator_dump_vcd</span></code></a> to 1. It takes the file name from
<code class="xref c c-data docutils literal notranslate"><span class="pre">simulator_vcd_name</span></code>. DUMP_VCD overrides this variable.</p>
</dd></dl>

<dl class="var">
<dt>
<code class="sig-name descname">const char *simulator_vcd_name;</code></dt>
<dd><p>Specifies the name of the vcd file. Defaults to
“dump.vcd”. DUMP_VCD overrides this variable.</p>
</dd></dl>

</div>
<div class="section" id="zynq-clock-control">
<h2><span class="section-number">1.5. </span>Zynq Clock Control<a class="headerlink" href="#zynq-clock-control" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.setClockFrequency">
void <code class="sig-name descname">setClockFrequency</code><span class="sig-paren">(</span>int<em> clkNum</em>, long<em> requestedFrequency</em>, long<em> *actualFrequency</em><span class="sig-paren">)</span><a class="headerlink" href="#c.setClockFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the frequency of Zynq FPGA Clock clkNum to the closest
frequency to requestedFrequency available from the PLL. If the
actualFrequency pointer is non-null, stores the actual freqency
before returning.</p>
</dd></dl>

</div>
<div class="section" id="portal-memory">
<h2><span class="section-number">1.6. </span>Portal Memory<a class="headerlink" href="#portal-memory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.portalAlloc">
int <code class="sig-name descname">portalAlloc</code><span class="sig-paren">(</span>size_t<em> size</em>, int<em> cached</em><span class="sig-paren">)</span><a class="headerlink" href="#c.portalAlloc" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses portalmem to allocate a region of size bytes.</p>
<p>On platforms that support non-cache-coherent I/O (e.g., zedboard),
cached=0 indicates that the programmable logic will use a port to
memory that is not snooped by the CPU’s caches. In this case, it is
up to the allocation to flush or invalidate the CPU cache as
needed, using portalCacheFlush().</p>
<p>Returns the file descriptor associated with the memory region.</p>
</dd></dl>

<dl class="function">
<dt id="c.portalMmap">
void *<code class="sig-name descname">portalMmap</code><span class="sig-paren">(</span>int<em> fd</em>, size_t<em> size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.portalMmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory maps size bytes of the portal memory region indicated by fd.</p>
<p>Returns a pointer to memory on success or -1 on failure.</p>
</dd></dl>

<dl class="function">
<dt id="c.portalCacheFlush">
<code class="sig-name descname">portalCacheFlush</code><span class="sig-paren">(</span>int<em> fd</em>, void<em> *__p</em>, long<em> size</em>, int<em> flush</em><span class="sig-paren">)</span><a class="headerlink" href="#c.portalCacheFlush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="portalpoller">
<h1><span class="section-number">2. </span>PortalPoller<a class="headerlink" href="#portalpoller" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="_CPPv412PortalPoller">
<span id="_CPPv312PortalPoller"></span><span id="_CPPv212PortalPoller"></span><span id="PortalPoller"></span><em class="property">class </em><code class="sig-name descname">PortalPoller</code><a class="headerlink" href="#_CPPv412PortalPoller" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Polls portals</p>
<dl class="member">
<dt>
<code class="sig-name descname">PortalPoller::PortalPoller(int autostart = 1)</code></dt>
<dd><p>If autostart is 1, then invoke <code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">start()</span></code> from <code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">registerInstance()</span></code></p>
</dd></dl>

<dl class="member">
<dt>
<code class="sig-name descname">void PortalPoller::start();</code></dt>
<dd><p>Starts the poller. Called automatically from <code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">registerInstance()</span></code> if <code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">autostart</span></code> is 1.</p>
</dd></dl>

<dl class="member">
<dt>
<code class="sig-name descname">void PortalPoller::stop();</code></dt>
<dd><p>Stops the poller.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv4N12PortalPoller12PortalPoller7timeoutE">
<span id="_CPPv3N12PortalPoller12PortalPoller7timeoutE"></span><span id="_CPPv2N12PortalPoller12PortalPoller7timeoutE"></span><span id="PortalPoller::PortalPoller::timeout__i"></span>int <code class="sig-prename descclassname">PortalPoller<code class="sig-prename descclassname">::</code></code><code class="sig-name descname">timeout</code><a class="headerlink" href="#_CPPv4N12PortalPoller12PortalPoller7timeoutE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The timeout value, in milliseconds, passed to <a href="#id1"><span class="problematic" id="id2">:c:function:`poll()`</span></a></p>
</dd></dl>

</dd></dl>

<p><span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PORTAL_TIMEOUT</span></code>.</p>
<blockquote>
<div><p>Overrides the default value for <code class="xref cpp cpp-member docutils literal notranslate"><span class="pre">PortalPoller::timeout</span></code>.</p>
</div></blockquote>
<div class="section" id="deprecated-functions">
<h2><span class="section-number">2.1. </span>Deprecated Functions<a class="headerlink" href="#deprecated-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.portalExec">
void *<code class="sig-name descname">portalExec</code><span class="sig-paren">(</span>void<em> *__x</em><span class="sig-paren">)</span><a class="headerlink" href="#c.portalExec" title="Permalink to this definition">¶</a></dt>
<dt id="c.handlers.">
Polls the registered portals and invokes their callback <code class="sig-name descname">handlers.</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.handlers." title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c.portalExec_start">
void <code class="sig-name descname">portalExec_start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.portalExec_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c.portalExec_poll">
void <code class="sig-name descname">portalExec_poll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#c.portalExec_poll" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. C/C++ Portal</a><ul>
<li><a class="reference internal" href="#connecting-to-bluesim">1.1. Connecting to Bluesim</a></li>
<li><a class="reference internal" href="#connecting-to-xsim-and-verilator">1.2. Connecting to Xsim and Verilator</a></li>
<li><a class="reference internal" href="#automatically-programming-the-fpga">1.3. Automatically Programming the FPGA</a></li>
<li><a class="reference internal" href="#tracing-simulation">1.4. Tracing Simulation</a></li>
<li><a class="reference internal" href="#zynq-clock-control">1.5. Zynq Clock Control</a></li>
<li><a class="reference internal" href="#portal-memory">1.6. Portal Memory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#portalpoller">2. PortalPoller</a><ul>
<li><a class="reference internal" href="#deprecated-functions">2.1. Deprecated Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="c.html"
                        title="previous chapter">Connectal C/C++ Libraries</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../examples/index.html"
                        title="next chapter">Connectal Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/c/portal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../bsv-pkgindex.html" title="Bsv Package Index"
             >bsvpkgs</a> |</li>
        <li class="right" >
          <a href="../examples/index.html" title="Connectal Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="c.html" title="Connectal C/C++ Libraries"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">connectal 20.05.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="c.html" >Connectal C/C++ Libraries</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015-2020, Jamey Hicks, Myron King, John Ankcorn.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>